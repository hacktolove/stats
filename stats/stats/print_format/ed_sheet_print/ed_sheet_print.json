{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2025-09-25 12:12:11.711394",
 "css": "@media print {\n    .letter-head-footer {\n      position: fixed ;\n      bottom: 0%;\n      left:0% ;\n      right:0%;\n      z-index:-1;\n    }\n}\n\n.print-format td {\n    padding:3px !important;\n}",
 "custom_format": 1,
 "default_print_language": "ar",
 "disabled": 0,
 "doc_type": "Education Allowance Sheet ST",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "{%- from \"templates/print_formats/standard_macros.html\" import add_header, render_field, print_value, fieldmeta, get_width, get_align_class with context -%}\n\n{% if print_settings.repeat_header_footer %}\n    <div id=\"header-html\">\n        {% if letter_head and not no_letterhead %}\n            <div class=\"letter-head\">{{ letter_head }}</div>\n        {% else%}\n             <div>\n               <table>\n                <tr></tr>\n               </table>\n               </div>\n        {% endif %}\n   </div>\n{% endif %}\n\n<div style=\"font-size:13pt; color:black;\">\n    {% set educational_year = frappe.db.get_value(\"Education Allowance Request ST\", doc.education_allowance_sheet_details[0].education_allowance_request_reference, \"educational_year\") %}\n    <h2 style=\"font-size:13pt; color:black; direction:rtl; text-align:center; font-weight:bold;\">\n       \u0645\u0633\u064a\u0631 \u0628\u062f\u0644 \u0627\u0644\u062a\u0639\u0644\u064a\u0645 \u0644\u0634\u0647\u0631 \u064a\u0648\u0646\u064a\u0648 \u0639\u0627\u0645 - ({{educational_year}})\u0645  \u0628\u0645\u0648\u062c\u0628 \u0627\u0644\u0642\u0631\u0627\u0631 \u0631\u0642\u0645 ({{doc.name}})\n    </h2>\n    \n    <table style=\"font-size:11pt; color:black; border:1px solid black; width:100%; margin-top:15px;\">\n        <thead>\n            <tr>\n                <td style=\"border:1px solid black; color:black; text-align:center; font-weight:bold; width:5%;\">{{_(\"Sr\")}}</td>\n                <td style=\"border:1px solid black; color:black; text-align:center; font-weight:bold; width:20%;\">{{_(\"Employee Name\")}}</td>\n                <td style=\"border:1px solid black; color:black; text-align:center; font-weight:bold; width:10%;\">{{_(\"ID/Residency Number\")}}</td>\n                <td style=\"border:1px solid black; color:black; text-align:center; font-weight:bold; width:15%;\">{{_(\"Sub Department\")}}</td>\n                <td style=\"border:1px solid black; color:black; text-align:center; font-weight:bold; width:10%;\">{{_(\"Grade\")}}</td>\n                <td style=\"border:1px solid black; color:black; text-align:center; font-weight:bold; width:15%;\">{{_(\"Season\")}}</td>\n                <td style=\"border:1px solid black; color:black; text-align:center; font-weight:bold; width:10%;\">{{_(\"No of Kids\")}}</td>\n                <td style=\"border:1px solid black; color:black; text-align:center; font-weight:bold; width:15%;\">{{_(\"Total Due Amount\")}}</td>\n            </tr>\n        </thead>\n        \n       <tbody>\n           \n            {% set unique_emps = [] %}\n            {% for d in doc.education_allowance_sheet_details %}\n                {% if d.employee_no not in unique_emps %}\n                    {{ unique_emps.append(d.employee_no) or \"\" }}\n                {% endif %}\n            {% endfor %}\n            \n            {% set emp_map = {} %}\n            {% for emp in unique_emps %}\n                {{ emp_map.update({emp : {\"no_of_child\": 0, \"season\": '', \"amnt\" : 0}}) or \"\" }}\n            {% endfor %}\n            \n            {% for emp in unique_emps %}\n                {% for d in doc.education_allowance_sheet_details %}\n                    {% if d.employee_no == emp %}\n                        {% set no_of_kids = frappe.db.get_value(\"Education Allowance Request ST\", d.education_allowance_request_reference , \"no_of_kids\") %}\n                        {% set season = frappe.db.get_value(\"Education Allowance Request ST\", d.education_allowance_request_reference , \"season\") %}\n                        {{ emp_map[emp].update({\"no_of_child\" : emp_map[emp]['no_of_child'] + no_of_kids, \"season\" : season, \"amnt\" : emp_map[emp]['amnt'] + d.approved_amount}) or \"\" }}\n                    {% endif %}\n                {% endfor %}\n            {% endfor %}\n        \n            {% set unique_employees = [] %}\n            {% set c = namespace(count=0) %}\n            {% for d in doc.education_allowance_sheet_details %}\n                {% if d.employee_no not in unique_employees %}\n                    {{ unique_employees.append(d.employee_no) or \"\" }}\n                    {% set c.count = c.count + 1 %}\n                    <tr>\n                        <td style=\"border:1px solid black; color:black; text-align:center;\">{{c.count}}</td>\n                        <td style=\"border:1px solid black; color:black; text-align:center;\">{{d.employee_name}}</td>\n                        <td style=\"border:1px solid black; color:black; text-align:center;\">{{frappe.db.get_value(\"Employee\", d.employee_no, \"custom_idresidency_number\")}}</td>\n                        <td style=\"border:1px solid black; color:black; text-align:center;\">{{frappe.db.get_value(\"Department\", d.sub_department, \"department_name\")}}</td>\n                        <td style=\"border:1px solid black; color:black; text-align:center;\">{{d.grade}}</td>\n                        <td style=\"border:1px solid black; color:black; text-align:center;\">{{emp_map[d.employee_no]['season']}}</td>\n                        <td style=\"border:1px solid black; color:black; text-align:center;\">{{emp_map[d.employee_no]['no_of_child']}}</td>\n                        <td style=\"border:1px solid black; color:black; text-align:center;\">{{emp_map[d.employee_no]['amnt']}}</td>\n                    </tr>\n                {% endif %}\n           {% endfor %}\n           \n           <tr>\n               <td colspan=\"2\" style=\"border:1px solid black; color:black; text-align:center; font-weight:bold;\">Total</td>\n               <td  colspan=\"6\" style=\"border:1px solid black; color:black; text-align:left; font-weight:bold;\">{{ frappe.format(doc.total_approved_amount, \"Currency\") }}</td>\n           </tr>\n       </tbody>\n    \n    </table>\n    \n    {% set wf_data = frappe.db.get_all(\"Workflow Action\", {\"reference_doctype\": \"Education Allowance Sheet ST\", \"reference_name\":doc.name}, [\"workflow_state\", \"status\", \"completed_by\"], order_by=\"creation\")%}\n    <h3 style=\"text-align:right; font-weight:bold;\">\n       {{_(\"Approvals:\")}}\n    </h3>\n    <table style=\"font-size:12pt; color:black; width:100%; border:1px solid black; direction:rtl; table-layout:fixed; margin-top:15px;\">\n        <thead>\n            <tr>\n                <td style=\"border:1px solid black; text-align:center; font-weight:bold; width:40%;\">Approval State</td>\n                <td style=\"border:1px solid black; text-align:center; font-weight:bold; width:40%;\">Approved By User</td>\n                <td style=\"border:1px solid black; text-align:center; font-weight:bold; width:20%;\">Status</td>\n            </tr>\n        </thead>\n        <tbody>\n            {% for d in wf_data %}\n                <tr>\n                    <td style=\"text-align:center; border:1px solid black; vertical-align:middle !important;\">{{d['workflow_state']}}</td>\n                    <td style=\"text-align:center; border:1px solid black; vertical-align:middle !important;\">{{frappe.db.get_value(\"User\", d['completed_by'], \"full_name\") or \"\"}}</td>\n                    <td style=\"text-align:center; border:1px solid black; vertical-align:middle !important;\">{{_(d['status'])}}</td>\n                </tr>\n            {% endfor %}\n        </tbody>\n    </table>\n</div>\n\n{% if print_settings.repeat_header_footer %}\n<div id=\"footer-html\">\n    {% if footer %}\n    <div class=\"letter-head-footer\"> {{ footer }} </div>\n    {% endif %}\n    <p class=\"text-center small page-number visible-pdf\">\n        {{ _(\"Page {0} of {1}\").format('<span class=\"page\"></span>', '<span class=\"topage\"></span>') }} </p>\n</div>\n{% endif %}",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2025-09-29 15:22:21.689514",
 "modified_by": "Administrator",
 "module": "Stats",
 "name": "ED Sheet Print",
 "owner": "Administrator",
 "page_number": "Hide",
 "pdf_generator": "wkhtmltopdf",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_for": "DocType",
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}